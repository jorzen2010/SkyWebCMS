@{
    ViewBag.Title = "用户管理";
    ViewBag.SmallTitle = "用户添加";
}
<div class="page-content">
    <div class="page-header">
        <h1>
            中医体质自测结果

        </h1>

    </div><!-- /.page-header -->
    <div class="row">
        <div class="col-xs-1"></div>
        <div class="col-xs-10">
            <table class="table table-striped table-bordered  h4" border="1">
                <tr>
                    <td colspan="2" class="h3 center">@ViewBag.Id 中 医 体 质 辨 识 报 告</td>
                </tr>
                <tr>
                    <td class="col-xs-6">档案号：</td>


                    <td class="col-xs-6">测评机构：</td>

                </tr>
                <tr>
                    <td>姓名：</td>


                    <td>性别：</td>

                </tr>
                <tr>
                    <td>出生日期：</td>
           

                    <td>测评时间：</td>
           
                </tr>
                <tr>
                    <td colspan="2">【体质得分】</td>
                </tr>
                <tr>
                    <td colspan="2">根据测评，您的体质得分情况如下：</td>
                </tr>
                <tr>
                    <td colspan="2"><div id="main" style="height:400px;"></div></td>
                </tr>
                <tr>
                    <td colspan="2">【体质结果】</td>
                </tr>
                <tr>
                    <td colspan="2">您的主要体质类型是：属于偏颇体质</td>
                </tr>
                <tr>
                    <td colspan="2">【健康指导建议】</td>
                </tr>
                <tr>
                    <td colspan="2">食宜益气固表，宜清淡、均衡，粗细搭配适当，荤素配伍合理。多食益气固表的食物，少食荞麦（含致敏物质荞麦荧光素）、蚕豆、白扁豆、牛肉、鹅肉、鲤鱼、虾、蟹、茄子、酒、辣椒、浓茶、咖啡等辛辣之品、腥膻发物及含致敏物质的食物。推荐药膳：葱白红枣鸡肉粥。起居应通风良好、避免过敏原，加强锻炼，防寒保暖。</td>
                </tr>
            </table>
            </div>
            <div class="col-xs-1"></div>
        </div>
        </div>






        <!-- ECharts单文件引入 -->
        @section BottomScripts {
            <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
            <script type="text/javascript">
                // 路径配置
                require.config({
                    paths: {
                        echarts: 'http://echarts.baidu.com/build/dist'
                    }
                });

                // 使用
                require(
                    [
                        'echarts',
                        'echarts/chart/bar',
                        'echarts/chart/line' // 使用柱状图就加载bar模块，按需加载
                    ],
                    function (ec) {
                        // 基于准备好的dom，初始化echarts图表
                        var myChart = ec.init(document.getElementById('main'));

                        var option = {
                            title: {
                                text: "中医体质测评结果",
                                x:"center",
                            },
                            tooltip: {
                                show: true
                            },
                            
                            xAxis: [
                                {
                                    type: 'category',
                                    data: ["阳虚质", "阴虚质", "气虚质", "痰湿质", "湿热质", "血瘀质", "气郁质", "特禀质", "平和质"]
                                }
                            ],
                            yAxis: [
                                {
                                    type: 'value'
                                }
                            ],
                            series: [
                                {
                                    "name": "体质得分",
                                    "type": "bar",
                                    "itemStyle": {

                                        normal: { label: { show: true }, color: '#ff0000' },// for legend

                                        emphasis: { label: { show: true } }

                                    },
                                    "data":
                                        [@ViewBag.yangxuzhiresult,
                                        @ViewBag.yinxuzhiresult,
                                        @ViewBag.qixuzhiresult,
                                        @ViewBag.tanshizhiresult,
                                        @ViewBag.shirezhiresult,
                                        @ViewBag.xueyuzhiresult,
                                        @ViewBag.qiyuzhiresult,
                                        @ViewBag.tebingzhiresult,
                                        @ViewBag.pinghezhiresult],
                                    "markLine": {
                                        data: [
                                         [{ name: '倾向分数线', value: 30, xAxis: -1, yAxis: 30 }, { xAxis: 9, yAxis: 30 }],
                                         [{ name: '确定分数线', value: 40, xAxis: -1, yAxis: 40 }, { xAxis: 9, yAxis: 40 }]
                                        ]
                                    }



                              



                        }
                            ],


                            animation: false
                        };

                        // 为echarts对象加载数据
                        myChart.setOption(option);


                        // 保存图片
                        setTimeout(exportImage(myChart.getDataURL("png")), 30000);

                    }
                );

                function exportImage(a) {
                    var data = "a=" + encodeURIComponent(a);
                    var xmlhttp;
                    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
                        xmlhttp = new XMLHttpRequest();
                    } else { // code for IE6, IE5
                        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                    }
                    xmlhttp.open("POST", "/Liangbiao/Test", true);
                    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                    xmlhttp.onreadystatechange = function () {
                        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                            // alert("保存成功");
                        }
                    }
                    xmlhttp.send(data);


                }
            </script>
        }
